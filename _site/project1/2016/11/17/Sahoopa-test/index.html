<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Data Science and the intuitions behind it">
    
    <!-- <link rel="icon" type="image/x-icon" href="http://ds.gregvi.al/favicon.ico"> -->
    <!-- favicon -->
    <link rel="shortcut icon" href="http://ds.gregvi.alfavicon.ico">

    <title>Titanic Notebook test - Data Salience</title>

    <link rel="canonical" href="http://ds.gregvi.al/project1/2016/11/17/Sahoopa-test/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://ds.gregvi.al/feed.xml" title="Data Salience" />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Data Salience</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
				
                <li>
                    <a href="/about/">About</a>
                </li>
				
                
				
                <li>
                    <a href="/contact/">Contact</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/home-bg.jpg');">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading" style="padding: 30px 0">
                    <h1>Titanic Notebook test</h1>
                    
                    <h2 class="subheading">Showcasing Jupyter Notebook Translator Layout</h2>
                    
                    <span class="meta">Posted by Palavi Sahoopa on November 17, 2016</span>	
                </div>
            </div>
        </div>
    </div>
</header>



	
	
		
	

<!-- Also Interesting -->



	
	
	

	
	 
	
	
	

	
	 
	
	
	

	
	 
	
	
	

	
	 
	
	
	

	
	 
	
	
	

	
	 
	
	
	

	
	 
	
	
	


		</div>
		</div>

<!-- Post Content -->
<style>
img {
	display:block;
	max-width:  100%;
	margin-left: auto;
	margin-right: auto;
}

@media only screen and (min-width: 1000px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.2); 
	-webkit-transform:scale(1.2);
	-o-transform:scale(1.2);
}
}

@media only screen and (min-width: 1250px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.5); 
	-webkit-transform:scale(1.5);
	-o-transform:scale(1.5);
}
}

@media only screen and (min-width: 1500px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(2); 
	-webkit-transform:scale(2);
	-o-transform:scale(2);
}
}
</style>

<article>
    <div id="content" class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span><span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">import</span> <span class="nn">brewer2mpl</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre>
</div>

<p>Every data scientist begins their journey of exploring the world of data science using Titanic data and I am no exception. I am learning data science using Python and it has been a great experience working on titanic data for a few reasons..</p>
<ol>
  <li>Even though the data sample is as small as 891 observations and 11 features, this data has the beauty to experiment various techniques of data science very easily. It has a good mix of categorical variables and numeric variables. The categories in each variable is just 3-4, which is a good opportunity for a novice data scientist to experiement. 
The data has a few missing values and a few outliers too  which is great for learning.</li>
</ol>

<h3 id="objective">Objective</h3>
<p>This is a classification problem where the goal is to identify the likelihood of passenger being survived.</p>

<h3 id="technique">2. Technique</h3>
<p>Since it’s a classificatin problem, I will be using Logistic Regression and Decision trees</p>

<h3 id="model-evaluation-criteria">3. Model evaluation criteria</h3>
<p>AUC, accuracy</p>

<h2 id="part-1-aquire-the-data">Part 1: Aquire the Data</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">psql</span> <span class="o">-</span><span class="n">h</span> <span class="n">dsi</span><span class="o">.</span><span class="n">c20gkj5cvu3l</span><span class="o">.</span><span class="n">us</span><span class="o">-</span><span class="n">east</span><span class="o">-</span><span class="mf">1.</span><span class="n">rds</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span><span class="n">p</span> <span class="mi">5432</span> <span class="o">-</span><span class="n">U</span> <span class="n">dsi_student</span> <span class="n">titanic</span>
<span class="n">password</span><span class="p">:</span> <span class="n">gastudents</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  File "&lt;ipython-input-2-b0485d6fae25&gt;", line 1
    psql -h dsi.c20gkj5cvu3l.us-east-1.rds.amazonaws.com -p 5432 -U dsi_student titanic
              ^
SyntaxError: invalid syntax
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s">'postgresql://postgres:postgres@localhost:5432'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s">"select * from information_schema.tables limit 5;"</span> <span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>table_catalog</th>
      <th>table_schema</th>
      <th>table_name</th>
      <th>table_type</th>
      <th>self_referencing_column_name</th>
      <th>reference_generation</th>
      <th>user_defined_type_catalog</th>
      <th>user_defined_type_schema</th>
      <th>user_defined_type_name</th>
      <th>is_insertable_into</th>
      <th>is_typed</th>
      <th>commit_action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>postgres</td>
      <td>pg_catalog</td>
      <td>pg_statistic</td>
      <td>BASE TABLE</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>YES</td>
      <td>NO</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>postgres</td>
      <td>pg_catalog</td>
      <td>pg_type</td>
      <td>BASE TABLE</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>YES</td>
      <td>NO</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>postgres</td>
      <td>public</td>
      <td>table1</td>
      <td>BASE TABLE</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>YES</td>
      <td>NO</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>postgres</td>
      <td>pg_catalog</td>
      <td>pg_authid</td>
      <td>BASE TABLE</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>YES</td>
      <td>NO</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>postgres</td>
      <td>public</td>
      <td>evictions_simple</td>
      <td>BASE TABLE</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>YES</td>
      <td>NO</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">%</span><span class="n">load_ext</span> <span class="n">sql</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>The sql extension is already loaded. To reload it, use:
  %reload_ext sql
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">%%</span><span class="n">sql</span> <span class="n">postgresql</span><span class="p">:</span><span class="o">//</span><span class="n">postgres</span><span class="p">:</span><span class="n">postgres</span><span class="nd">@localhost</span><span class="p">:</span><span class="mi">5432</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>UsageError: %%sql is a cell magic, but the cell body is empty. Did you mean the line magic %sql (single %)?
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># sqlalchemy</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"commit"</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"create database titanic"</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">%%</span><span class="n">sql</span> <span class="n">create</span> <span class="n">database</span> <span class="n">titanic</span><span class="p">;</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>UsageError: %%sql is a cell magic, but the cell body is empty. Did you mean the line magic %sql (single %)?
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">%%</span><span class="n">sql</span>
<span class="n">DROP</span> <span class="n">TABLE</span> <span class="n">IF</span> <span class="n">EXISTS</span> <span class="n">titanic</span><span class="p">;</span>
<span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">titanic</span>
<span class="p">(</span><span class="s">"Passenger ID"</span> <span class="n">integer</span><span class="p">,</span>
 <span class="s">"Survived"</span> <span class="n">varchar</span><span class="p">,</span>
 <span class="s">"Pclass"</span> <span class="n">varchar</span><span class="p">,</span>
 <span class="s">"Name"</span> <span class="n">varchar</span><span class="p">,</span>
 <span class="s">"Sex"</span> <span class="n">varchar</span><span class="p">,</span>
 <span class="s">"Age"</span> <span class="n">varchar</span><span class="p">,</span>
 <span class="s">"SibSp"</span> <span class="n">varchar</span><span class="p">,</span>
 <span class="s">"Parch"</span> <span class="n">varchar</span><span class="p">,</span>
 <span class="s">"Ticket"</span> <span class="n">varchar</span><span class="p">,</span>
 <span class="s">"Fare"</span> <span class="n">varchar</span><span class="p">,</span>
 <span class="s">"Cabin"</span> <span class="n">varchar</span><span class="p">,</span>
 <span class="s">"Embarked"</span> <span class="n">varchar</span><span class="p">);</span>


<span class="n">COPY</span> <span class="n">evictions_simple</span> <span class="n">FROM</span> <span class="s">'postgresql://dsi_student:gastudents@dsi.c20gkj5cvu3l.us-east-1.rds.amazonaws.com/titanic'</span> <span class="n">delimiter</span> <span class="s">','</span> <span class="n">csv</span> <span class="n">header</span><span class="p">;</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Done.
Done.
(psycopg2.OperationalError) could not open file "postgresql://dsi_student:gastudents@dsi.c20gkj5cvu3l.us-east-1.rds.amazonaws.com/titanic" for reading: No such file or directory
 [SQL: "COPY evictions_simple FROM 'postgresql://dsi_student:gastudents@dsi.c20gkj5cvu3l.us-east-1.rds.amazonaws.com/titanic' delimiter ',' csv header;"]
</code></pre>
</div>

<h4 id="connect-to-the-remote-database">1. Connect to the remote database</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s">'postgresql://dsi_student:gastudents@dsi.c20gkj5cvu3l.us-east-1.rds.amazonaws.com/titanic'</span><span class="p">)</span>

</code></pre>
</div>

<h4 id="query-the-database-and-aggregate-the-data">2. Query the database and aggregate the data</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># We will pull in the Titanic data as before</span>
<span class="n">titanic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s">'SELECT * FROM train'</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">shape</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>(891, 13)
</code></pre>
</div>

<h3 id="data-description--">Data Description -</h3>

<p>Passenger ID : A seemingly unique number assigned to each passenger</p>

<p>Survived : A binary indicator of survival (0 = died, 1 = survived)</p>

<p>Pclass : A proxy for socio-economic status (1 = upper, 3 = lower)</p>

<p>Name : Passenger’s Name. For wedded women, her husband’s name appears first and her maiden name appears in parentheses</p>

<p>Sex : General indication of passenger’s sex</p>

<p>Age : Age of passenger (or approximate age). Passengers under the age of 1 year have fractional ages</p>

<p>SibSp : A count of the passenger’s siblings or spouses aboard</p>

<p>Parch : A count of the passenger’s parents or siblings aboard</p>

<p>Ticket : The number printed on the ticket. The numbering system is not immediately apparent</p>

<p>Fare : The price for the ticket (presumably in pounds, shillings, and pennies)</p>

<p>Cabin : Cabin number occupied by the passenger (this field is quite empty)</p>

<p>Embarked : The port from which the passenger boarded the ship</p>

<h2 id="data-exploration-">Data Exploration :</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>/Users/ipm/anaconda/lib/python2.7/site-packages/numpy/lib/function_base.py:3834: RuntimeWarning: Invalid value encountered in percentile
  RuntimeWarning)
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>445.000000</td>
      <td>446.000000</td>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
    </tr>
    <tr>
      <th>std</th>
      <td>257.353842</td>
      <td>257.353842</td>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>222.500000</td>
      <td>223.500000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>445.000000</td>
      <td>446.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>667.500000</td>
      <td>668.500000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>890.000000</td>
      <td>891.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">dtypes</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>index            int64
PassengerId      int64
Survived         int64
Pclass           int64
Name            object
Sex             object
Age            float64
SibSp            int64
Parch            int64
Ticket          object
Fare           float64
Cabin           object
Embarked        object
dtype: object
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Finding missing values</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">titanic</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">col</span> <span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>index 0
PassengerId 0
Survived 0
Pclass 0
Name 0
Sex 0
Age 177
SibSp 0
Parch 0
Ticket 0
Fare 0
Cabin 687
Embarked 2
</code></pre>
</div>

<ol>
  <li>20% of the age data has missing values</li>
  <li>75% of cabins have missing values</li>
  <li>Only 2 customers have missing values in Embarked</li>
</ol>

<p>Hypothesis I would like to test:</p>
<ol>
  <li>Is Sex important in predicting the survival? My hypothesis is if the passenger is female, then passenger will have higher survival rate</li>
  <li>Is age important in predicting the survival? My hypothesis is that if the passenger is child/baby, then passenger will have higher survival rate</li>
  <li>Is nobility an important variable in predicting the survival? If passenger is a common person from class 3, can have less chance of survival, compared to the passenger from class 1/passenger having noble title</li>
  <li>Do family members have higher chances of survival than people who were travelling alone?</li>
  <li>Passengers who paid more might have higher chance of survival, as it also reflects that they were rich. So would be intersting to test, if the passengers who paid more had higher chances of survival or not</li>
  <li>Is there any signifant difference in the survival rates based on their embarked port?</li>
</ol>

<h2 id="part-2-exploratory-data-analysis">Part 2: Exploratory Data Analysis</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Let's have a look at the numeric/categorical variables distribution</span>

<span class="c"># Set up a grid of plots</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">fig_dims</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c"># Plot death and survival counts</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">fig_dims</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> 
                                         <span class="n">title</span><span class="o">=</span><span class="s">'Survived Vs Died Counts'</span><span class="p">)</span>

<span class="c"># Plot Pclass counts</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">fig_dims</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">'Pclass'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> 
                                       <span class="n">title</span><span class="o">=</span><span class="s">'Passenger Class Counts'</span><span class="p">)</span>

<span class="c"># Plot Sex counts</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">fig_dims</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">'Sex'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> 
                                    <span class="n">title</span><span class="o">=</span><span class="s">'Gender Counts'</span><span class="p">)</span>

<span class="c"># Plot Embarked counts</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">fig_dims</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> 
                                         <span class="n">title</span><span class="o">=</span><span class="s">'Port of Embarkation Counts'</span><span class="p">)</span>

<span class="c"># Plot the Age histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">fig_dims</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Age Distribution'</span><span class="p">)</span>

<span class="c"># Plot the Fare histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">fig_dims</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Fare Distribution'</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.text.Text at 0x11db55950&gt;
</code></pre>
</div>

<p><img src="output_24_1.png" alt="png" />
<img src="/Assets/output_24_1.png" /></p>

<ol>
  <li>Let’s test first hypothesis -
    <h3 id="is-sex-important-in-predicting-the-survival">IS sex important in predicting the survival</h3>
  </li>
</ol>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">group</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">"Sex"</span><span class="p">])[</span><span class="s">"Survived"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">group</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.257962</td>
      <td>0.742038</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.811092</td>
      <td>0.188908</td>
    </tr>
  </tbody>
</table>
</div>

<p>Almost 75% of the female passengers survived and only 19% male passengers survived. These is a significant difference between the survival rates of male and female. So it looks like our hypothesis is true</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">#normalize each row by transposing, normalizing each column, and un-transposing</span>
<span class="n">group</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">*</span> <span class="n">group</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="nb">sum</span><span class="p">())</span><span class="o">.</span><span class="n">T</span>

<span class="k">print</span> <span class="s">"Transpose"</span> <span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">T</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'Died'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bottom</span><span class="o">=</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span> <span class="s">'g'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'Survived'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="s">'female'</span><span class="p">,</span> <span class="s">'male'</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="s">'horizontal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Fraction"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Survival Rates by Gender"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'right'</span><span class="p">)</span>            
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Transpose Sex         female      male
Survived                    
0         0.257962  0.811092
1         0.742038  0.188908





&lt;matplotlib.legend.Legend at 0x11e7da710&gt;
</code></pre>
</div>

<p><img src="output_28_2.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">group</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stacked</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Seuvival rates by gender"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">"upper right"</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.legend.Legend at 0x11b31aad0&gt;
</code></pre>
</div>

<p><img src="output_29_1.png" alt="png" /></p>

<p>Sex looks to be a very important factor in survival rates… 75% of all females survived while only 19% male survived</p>

<h3 id="is-age-important-in-predicting-the-survival">Is age important in predicting the survival?</h3>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>177
</code></pre>
</div>

<p>We have 20% missing values in Age. We have to impute the missing values for age. 
Let’s see how can we impute the missing value for age… 
We can impute the age based on the title.. If the title is Mrs. then we can impute the age by taking the median for all the passengers having title as Mrs and so on…</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">extract_Salutation</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">"Salutation"</span><span class="p">]</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="s">"Name"</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">extract_Salutation</span><span class="p">)</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">"Salutation"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Mr              517
Miss            182
Mrs             125
Master           40
Dr                7
Rev               6
Mlle              2
Col               2
Major             2
Lady              1
Jonkheer          1
Don               1
Ms                1
Mme               1
Capt              1
the Countess      1
Sir               1
Name: Salutation, dtype: int64
</code></pre>
</div>

<p>Oh.. we have so many titles… But 13 of these 17 titles are very rare.. Only 1 or 2 passengers have these titles. 
Also these title reflects their nobility… Let’s keep the titles as Mr, Mrs, Miss, Master.</p>

<ol>
  <li>I am going to combine Ms with Miss,</li>
  <li>Mme, Mlle, Lady, the countess with Mrs</li>
  <li>Dr with Mr</li>
</ol>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">GroupSalutations</span><span class="p">(</span><span class="n">Salutation</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">Salutation</span> <span class="o">==</span> <span class="s">"Mr"</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">'Mr'</span>
    <span class="k">elif</span> <span class="n">Salutation</span> <span class="ow">in</span><span class="p">([</span><span class="s">"Mrs"</span><span class="p">,</span> <span class="s">"Mlle"</span><span class="p">,</span> <span class="s">"Lady"</span><span class="p">,</span> <span class="s">"Mme"</span><span class="p">,</span> <span class="s">"the Countess"</span><span class="p">]):</span>
        <span class="k">return</span> <span class="s">'Mrs'</span>
    <span class="k">elif</span> <span class="n">Salutation</span> <span class="ow">in</span><span class="p">([</span><span class="s">"Miss"</span><span class="p">,</span> <span class="s">"Ms"</span><span class="p">]):</span>
        <span class="k">return</span> <span class="s">"Miss"</span>
    <span class="k">elif</span> <span class="n">Salutation</span> <span class="o">==</span> <span class="s">"Master"</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"Master"</span>
<span class="c">#    elif Salutation == 'Dr':</span>
<span class="c">#        if Sex == 'male':</span>
<span class="c">#            return "Mr"</span>
<span class="c">#        else:</span>
<span class="c">#            return "Mrs"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"Mr"</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">"Salut_group"</span><span class="p">]</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="s">"Salutation"</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">GroupSalutations</span><span class="p">)</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">"Salut_group"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Mr        538
Miss      183
Mrs       130
Master     40
Name: Salut_group, dtype: int64
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">titanic</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Salutation</th>
      <th>Salut_group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>6</td>
      <td>0</td>
      <td>3</td>
      <td>Moran, Mr. James</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>330877</td>
      <td>8.4583</td>
      <td>None</td>
      <td>Q</td>
      <td>Mr</td>
      <td>Mr</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>18</td>
      <td>1</td>
      <td>2</td>
      <td>Williams, Mr. Charles Eugene</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>244373</td>
      <td>13.0000</td>
      <td>None</td>
      <td>S</td>
      <td>Mr</td>
      <td>Mr</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="lets-find-the-median-age-for-each-salutation-groups">Lets find the median Age for each salutation groups</h3>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">"Salut_group"</span><span class="p">])[</span><span class="s">"Age"</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">a</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Salut_group
Master     3.5
Miss      21.0
Mr        30.0
Mrs       35.0
Name: Age, dtype: float64
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">table</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s">'Age'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'Salut_group'</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Pclass'</span><span class="p">,</span> <span class="s">'Sex'</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="c">#print titanic[titanic['Age'].isnull()]</span>
<span class="k">print</span> <span class="n">table</span>
<span class="c"># Define function to return value of this pivot_table</span>
<span class="k">def</span> <span class="nf">impute_age</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">table</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s">'Pclass'</span><span class="p">]][</span><span class="n">x</span><span class="p">[</span><span class="s">'Sex'</span><span class="p">]][</span><span class="n">x</span><span class="p">[</span><span class="s">'Salut_group'</span><span class="p">]]</span>
<span class="c"># Replace missing values</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">impute_age</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Pclass  Sex     Salut_group
1       female  Master          NaN
                Miss           30.0
                Mr             49.0
                Mrs            39.0
        male    Master          4.0
                Miss            NaN
                Mr             42.0
                Mrs             NaN
2       female  Master          NaN
                Miss           24.0
                Mr              NaN
                Mrs            32.0
        male    Master          1.0
                Miss            NaN
                Mr             31.0
                Mrs             NaN
3       female  Master          NaN
                Miss           18.0
                Mr              NaN
                Mrs            31.0
        male    Master          4.0
                Miss            NaN
                Mr             26.0
                Mrs             NaN
dtype: float64
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">ind</span> <span class="o">=</span><span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">titanic</span><span class="o">.</span><span class="n">Salut_group</span> <span class="o">==</span> <span class="s">'Mr'</span><span class="p">][</span><span class="n">titanic</span><span class="o">.</span><span class="n">Sex</span> <span class="o">==</span> <span class="s">'female'</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>/Users/ipm/anaconda/lib/python2.7/site-packages/ipykernel/__main__.py:1: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
  if __name__ == '__main__':
</code></pre>
</div>

<p>We have 1 doctor who is female and we have replaced all doctors with Mr. So now we need to change this particular observation to be Mrs</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="s">"Salut_group"</span><span class="p">,</span> <span class="s">"Mrs"</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Salutation</th>
      <th>Salut_group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>None</td>
      <td>S</td>
      <td>Mr</td>
      <td>Mr</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>Mrs</td>
      <td>Mrs</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Salutation</th>
      <th>Salut_group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>796</th>
      <td>796</td>
      <td>797</td>
      <td>1</td>
      <td>1</td>
      <td>Leader, Dr. Alice (Farnham)</td>
      <td>female</td>
      <td>49.0</td>
      <td>0</td>
      <td>0</td>
      <td>17465</td>
      <td>25.9292</td>
      <td>D17</td>
      <td>S</td>
      <td>Dr</td>
      <td>Mrs</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>0
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Plot the Age histogram</span>
<span class="c"># Set up a grid of plots</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">fig_dims</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Age Distribution'</span><span class="p">)</span>

<span class="c">#normalize each row by transposing, normalizing each column, and un-transposing</span>
<span class="n">group</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">*</span> <span class="n">group</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="nb">sum</span><span class="p">())</span><span class="o">.</span><span class="n">T</span>

<span class="k">print</span> <span class="s">"Transpose"</span> <span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">T</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">fig_dims</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'g'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'Died'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bottom</span><span class="o">=</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span> <span class="s">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'Survived'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="s">'female'</span><span class="p">,</span> <span class="s">'male'</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="s">'horizontal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Fraction"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Survival Rates by Gender"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'best'</span><span class="p">)</span> 


</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Transpose Sex         female      male
Survived                    
0         0.257962  0.811092
1         0.742038  0.188908





&lt;matplotlib.legend.Legend at 0x11eb95390&gt;
</code></pre>
</div>

<p><img src="output_46_2.png" alt="png" /></p>

<p>Age looks pretty much normally distributed…
Almost 3 quarters of females survived while only 1 quarter of male survived</p>

<h3 id="do-family-members-have-higher-chances-of-survival-than-people-who-were-travelling-alone">Do family members have higher chances of survival than people who were travelling alone?</h3>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="p">[</span><span class="s">"Family_size"</span><span class="p">]</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="s">"Parch"</span><span class="p">]</span> <span class="o">+</span> <span class="n">titanic</span><span class="p">[</span><span class="s">"SibSp"</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">fm</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">"Family_size"</span><span class="p">])[</span><span class="s">"Survived"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">fm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Family Size Vs Survival rate'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Survival Rate"</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.text.Text at 0x11edf54d0&gt;
</code></pre>
</div>

<p><img src="output_49_1.png" alt="png" /></p>

<p>If the passenger was travelling alone, the chances of passenger being survived was 30%. However, if the passenger was travelling with a family of upto 4 people, the chances of survival has increased upto 72%. However, if the familt is more than 4 members, the chances of survival dimishes again.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Replace missing values for port of Embankment by the maximum occuring value for Embarked</span>
<span class="n">titanic</span><span class="p">[</span><span class="s">"Embarked"</span><span class="p">]</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">Embarked</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s">'S'</span><span class="p">)</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">"Embarked"</span><span class="p">)[</span><span class="s">"Survived"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Embarked</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C</th>
      <td>0.446429</td>
      <td>0.553571</td>
    </tr>
    <tr>
      <th>Q</th>
      <td>0.610390</td>
      <td>0.389610</td>
    </tr>
    <tr>
      <th>S</th>
      <td>0.660991</td>
      <td>0.339009</td>
    </tr>
  </tbody>
</table>
</div>

<p>It looks like there is some difference in survival rates based on their port of embarkment</p>

<h4 id="visualize-the-data">2. Visualize the Data</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">Fare</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>(array([ 732.,  106.,   31.,    2.,   11.,    6.,    0.,    0.,    0.,    3.]),
 array([   0.     ,   51.23292,  102.46584,  153.69876,  204.93168,
         256.1646 ,  307.39752,  358.63044,  409.86336,  461.09628,
         512.3292 ]),
 &lt;a list of 10 Patch objects&gt;)
</code></pre>
</div>

<p><img src="output_55_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">Fare</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>count    891.000000
mean      32.204208
std       49.693429
min        0.000000
25%        7.910400
50%       14.454200
75%       31.000000
max      512.329200
Name: Fare, dtype: float64
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">titanic</span><span class="o">.</span><span class="n">Fare</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>15
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s">'Age'</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="s">'Salut_group'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Age by Salutation"</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.text.Text at 0x1006371d0&gt;
</code></pre>
</div>

<p><img src="output_58_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s">'Fare'</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="s">'Pclass'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">250</span><span class="p">))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>(0, 250)
</code></pre>
</div>

<p><img src="output_59_1.png" alt="png" /></p>

<p>15 passengers did not pay any fare… while some passngers paid over 500. Data seems to be highly skewed on both sides. It might be data issue, so let’s fix it.. 
Let’s treat the outliers…</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">Fare</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.995</span><span class="p">,</span><span class="o">.</span><span class="mo">02</span><span class="p">])</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>count    891.000000
mean      32.204208
std       49.693429
min        0.000000
2%         6.397500
50%       14.454200
99.5%    263.000000
max      512.329200
Name: Fare, dtype: float64
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">titanic</span><span class="o">.</span><span class="n">Fare</span> <span class="o">&gt;</span> <span class="mi">263</span><span class="p">,</span> <span class="s">"Fare"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">263</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">titanic</span><span class="o">.</span><span class="n">Fare</span> <span class="o">&lt;</span><span class="mf">6.39</span><span class="p">,</span> <span class="s">"Fare"</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.39</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">Fare</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>count    891.000000
mean      31.476691
std       43.184946
min        6.390000
25%        7.910400
50%       14.454200
75%       31.000000
max      263.000000
Name: Fare, dtype: float64
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">Fare</span><span class="p">),</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>(array([ 316.,  113.,   82.,  128.,   77.,   53.,   56.,   28.,   18.,   20.]),
 array([ 1.85473427,  2.22647624,  2.59821822,  2.9699602 ,  3.34170217,
         3.71344415,  4.08518613,  4.4569281 ,  4.82867008,  5.20041206,
         5.57215403]),
 &lt;a list of 10 Patch objects&gt;)
</code></pre>
</div>

<p><img src="output_64_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="p">[</span><span class="s">"logFare"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">Fare</span><span class="p">)</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Salutation</th>
      <th>Salut_group</th>
      <th>Family_size</th>
      <th>logFare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>None</td>
      <td>S</td>
      <td>Mr</td>
      <td>Mr</td>
      <td>2</td>
      <td>1.981001</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>Mrs</td>
      <td>Mrs</td>
      <td>2</td>
      <td>4.266662</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">## Passengers survived</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">"Salut_group"</span><span class="p">,</span><span class="s">"Pclass"</span><span class="p">])[</span><span class="s">"Survived"</span><span class="p">]</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">a</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Pclass1"</span><span class="p">,</span> <span class="s">"Pclass2"</span><span class="p">,</span> <span class="s">"Pclass3"</span><span class="p">]</span>
<span class="n">a</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pclass1</th>
      <th>Pclass2</th>
      <th>Pclass3</th>
    </tr>
    <tr>
      <th>Salut_group</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Master</th>
      <td>3</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Miss</th>
      <td>44</td>
      <td>33</td>
      <td>51</td>
    </tr>
    <tr>
      <th>Mr</th>
      <td>42</td>
      <td>8</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Mrs</th>
      <td>47</td>
      <td>37</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">## Total passengers </span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">b</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">"Salut_group"</span><span class="p">,</span><span class="s">"Pclass"</span><span class="p">])[</span><span class="s">"Survived"</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">b</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Pclass1"</span><span class="p">,</span> <span class="s">"Pclass2"</span><span class="p">,</span> <span class="s">"Pclass3"</span><span class="p">]</span>
<span class="n">b</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pclass1</th>
      <th>Pclass2</th>
      <th>Pclass3</th>
    </tr>
    <tr>
      <th>Salut_group</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Master</th>
      <td>3</td>
      <td>9</td>
      <td>28</td>
    </tr>
    <tr>
      <th>Miss</th>
      <td>46</td>
      <td>35</td>
      <td>102</td>
    </tr>
    <tr>
      <th>Mr</th>
      <td>119</td>
      <td>99</td>
      <td>319</td>
    </tr>
    <tr>
      <th>Mrs</th>
      <td>48</td>
      <td>41</td>
      <td>42</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">## Percantage passengers survived</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">b</span>
<span class="n">c</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pclass1</th>
      <th>Pclass2</th>
      <th>Pclass3</th>
    </tr>
    <tr>
      <th>Salut_group</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Master</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.392857</td>
    </tr>
    <tr>
      <th>Miss</th>
      <td>0.956522</td>
      <td>0.942857</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>Mr</th>
      <td>0.352941</td>
      <td>0.080808</td>
      <td>0.112853</td>
    </tr>
    <tr>
      <th>Mrs</th>
      <td>0.979167</td>
      <td>0.902439</td>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">c</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Salutation group Vs Survival rate'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Survival Rate"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">"best"</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.legend.Legend at 0x11f6d9210&gt;
</code></pre>
</div>

<p><img src="output_73_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">### plot the class distribution ###</span>
<span class="kn">import</span> <span class="nn">brewer2mpl</span>
<span class="n">tclass</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'Pclass'</span><span class="p">,</span> <span class="s">'Survived'</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="k">print</span> <span class="n">tclass</span>
<span class="k">print</span> <span class="s">"tclass0"</span><span class="p">,</span> <span class="n">tclass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">dark2_colors</span> <span class="o">=</span> <span class="n">brewer2mpl</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="s">'Dark2'</span><span class="p">,</span> <span class="s">'Qualitative'</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">mpl_colors</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">tclass</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">dark2_colors</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">'Died'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">tclass</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bottom</span><span class="o">=</span><span class="n">tclass</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">dark2_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">'Survived'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="s">'1st Class'</span><span class="p">,</span> <span class="s">'2nd Class'</span><span class="p">,</span> <span class="s">'3rd Class'</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="s">'horizontal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Count"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'upper left'</span><span class="p">)</span>

<span class="c">#normalize each row by transposing, normalizing each column, and un-transposing</span>
<span class="n">tclass</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">*</span> <span class="n">tclass</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">tclass</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="nb">sum</span><span class="p">())</span><span class="o">.</span><span class="n">T</span>

<span class="k">print</span> <span class="s">"Transpose"</span> <span class="p">,</span> <span class="n">tclass</span><span class="o">.</span><span class="n">T</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">tclass</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">dark2_colors</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">'Died'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">tclass</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bottom</span><span class="o">=</span><span class="n">tclass</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">dark2_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">'Survived'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="s">'1st Class'</span><span class="p">,</span> <span class="s">'2nd Class'</span><span class="p">,</span> <span class="s">'3rd Class'</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="s">'horizontal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Fraction"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>


</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Survived    0    1
Pclass            
1          80  136
2          97   87
3         372  119
tclass0 Pclass
1     80
2     97
3    372
Name: 0, dtype: int64
Transpose Pclass          1         2         3
Survived                             
0         0.37037  0.527174  0.757637
1         0.62963  0.472826  0.242363





&lt;matplotlib.text.Text at 0x11fc805d0&gt;
</code></pre>
</div>

<p><img src="output_74_2.png" alt="png" /></p>

<p>High percenatge of class 1 and class 2 people survived and relatively small percentage of class 3 people survived</p>

<h2 id="part-3-data-wrangling">Part 3: Data Wrangling</h2>

<h4 id="create-dummy-variables-for-sex">1. Create Dummy Variables for <em>Sex</em></h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Salutation</th>
      <th>Salut_group</th>
      <th>Family_size</th>
      <th>logFare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>None</td>
      <td>S</td>
      <td>Mr</td>
      <td>Mr</td>
      <td>2</td>
      <td>1.981001</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>Mrs</td>
      <td>Mrs</td>
      <td>2</td>
      <td>4.266662</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">Sex</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">Sex</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s">'male'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'female'</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
</code></pre>
</div>

<p>Lets create a dummy variable to Pclass and Embarked</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">dummies</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Pclass"</span><span class="p">,</span> <span class="s">"Embarked"</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dummies</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">col</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">prefix</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">titanic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">titanic</span><span class="p">,</span> <span class="n">res</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Pclass
Embarked
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>...</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Salutation</th>
      <th>Salut_group</th>
      <th>Family_size</th>
      <th>logFare</th>
      <th>Pclass_1</th>
      <th>Pclass_2</th>
      <th>Embarked_C</th>
      <th>Embarked_Q</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>1</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>...</td>
      <td>None</td>
      <td>S</td>
      <td>Mr</td>
      <td>Mr</td>
      <td>2</td>
      <td>1.981001</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>0</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>...</td>
      <td>C85</td>
      <td>C</td>
      <td>Mrs</td>
      <td>Mrs</td>
      <td>2</td>
      <td>4.266662</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 21 columns</p>
</div>

<h2 id="part-4-logistic-regression-and-model-validation">Part 4: Logistic Regression and Model Validation</h2>

<h4 id="define-the-variables-that-we-will-use-in-our-classification-analysis">1. Define the variables that we will use in our classification analysis</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[[</span><span class="s">"Sex"</span><span class="p">,</span> <span class="s">"Age"</span><span class="p">,</span> <span class="s">"SibSp"</span><span class="p">,</span> <span class="s">"Parch"</span><span class="p">,</span> <span class="s">"Fare"</span><span class="p">,</span> <span class="s">"Family_size"</span><span class="p">,</span> <span class="s">"Pclass_2"</span><span class="p">,</span> <span class="s">"Pclass_1"</span><span class="p">,</span> <span class="s">"Embarked_C"</span><span class="p">,</span> <span class="s">"Embarked_Q"</span><span class="p">]]</span>
</code></pre>
</div>

<h4 id="transform-y-into-a-1-dimensional-array-for-scikit-learn">2. Transform “Y” into a 1-Dimensional Array for SciKit-Learn</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">y</span><span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">Survived</span>
</code></pre>
</div>

<h4 id="conduct-the-logistic-regression">3. Conduct the logistic regression</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="n">correlationMatrix</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="nb">abs</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlationMatrix</span><span class="p">,</span><span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x120155810&gt;
</code></pre>
</div>

<p><img src="output_89_1.png" alt="png" /></p>

<p>Family size is highly correlated to Parch and Sibsp. So I am going to remove Parch and Sibsp. It perfectly makes sense as I derived family size based on Sibsp and Parch
We have high negative correlation between Pclass2 and Pclass3. I will keep this as when I run the model, we will compare the results of Pclass2 Vs Pclass1 and Pclass3 vs Pclass1</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[[</span><span class="s">"Sex"</span><span class="p">,</span> <span class="s">"Age"</span><span class="p">,</span> <span class="s">"logFare"</span><span class="p">,</span> <span class="s">"Family_size"</span><span class="p">,</span> <span class="s">"Pclass_2"</span><span class="p">,</span> <span class="s">"Pclass_1"</span><span class="p">,</span> <span class="s">"Embarked_C"</span><span class="p">,</span> <span class="s">"Embarked_Q"</span><span class="p">]]</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="n">correlationMatrix</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="nb">abs</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlationMatrix</span><span class="p">,</span><span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11f5f4850&gt;
</code></pre>
</div>

<p><img src="output_92_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">#from sklearn.linear_model import LogisticRegression</span>
<span class="c">#from sklearn.model_selection import cross_val_score</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="c"># that's accuracy score for logistic regression</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'CV scores: {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Average CVScore: {:0.3f} +/- {:0.3f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>CV scores: [ 0.78787879  0.7979798   0.8013468 ]
Average CVScore: 0.796 +/- 0.006
</code></pre>
</div>

<h4 id="test-the-model-by-introducing-a-test-or-validaton-set">6. Test the Model by introducing a <em>Test</em> or <em>Validaton</em> set</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">logreg</span><span class="o">=</span><span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">=</span><span class="n">logreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions_test</span><span class="o">=</span><span class="n">logreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>


<span class="k">print</span><span class="p">(</span><span class="s">'CV scores: {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Average CVScore: {:0.3f} +/- {:0.3f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>CV scores: [ 0.78787879  0.7979798   0.8013468 ]
Average CVScore: 0.796 +/- 0.006
</code></pre>
</div>

<h4 id="predict-the-class-labels-for-the-test-set">7. Predict the class labels for the <em>Test</em> set</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[[</span><span class="s">"Survived"</span><span class="p">,</span> <span class="s">"Fare"</span><span class="p">,</span> <span class="s">"Pclass"</span><span class="p">,</span> <span class="s">"Age"</span><span class="p">]],</span><span class="n">hue</span> <span class="o">=</span> <span class="s">"Survived"</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;seaborn.axisgrid.PairGrid at 0x11fa086d0&gt;
</code></pre>
</div>

<p><img src="output_97_1.png" alt="png" /></p>

<h4 id="evaluate-the-test-set">9. Evaluate the <em>Test</em> set</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span><span class="p">,</span> <span class="n">linear_model</span><span class="p">,</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span>
    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">'C'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="o">**-</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span>
                 <span class="s">'penalty'</span><span class="p">:[</span><span class="s">'l1'</span><span class="p">,</span><span class="s">'l2'</span><span class="p">],</span>
                 <span class="s">'fit_intercept'</span><span class="p">:[</span><span class="bp">True</span><span class="p">]},</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">scoring</span> <span class="o">=</span> <span class="s">'roc_auc'</span>
    <span class="p">)</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span>
<span class="c">#gs.grid_scores_</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="err">'penalty':</span><span class="w"> </span><span class="err">'l2',</span><span class="w"> </span><span class="err">'C':</span><span class="w"> </span><span class="err">1,</span><span class="w"> </span><span class="err">'fit_intercept':</span><span class="w"> </span><span class="err">True</span><span class="p">}</span><span class="w"> </span><span class="mf">0.849270042572</span><span class="w">
</span></code></pre>
</div>

<p>We had a wide range of C parameter.. From the first run, we have found that C = 1… Now, lets try to tune C with a smaller range and see if we get any improvement in predictions</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_predict</span><span class="p">,</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">average_precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">precision_score</span>

<span class="c"># Fit the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="c"># Tune the hyper parameters using grid search</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span>
    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">'C'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                 <span class="s">'penalty'</span><span class="p">:[</span><span class="s">'l1'</span><span class="p">,</span><span class="s">'l2'</span><span class="p">],</span>
                 <span class="s">'fit_intercept'</span><span class="p">:[</span><span class="bp">True</span><span class="p">],</span>
                 <span class="s">'solver'</span><span class="p">:[</span><span class="s">'liblinear'</span><span class="p">]},</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">scoring</span> <span class="o">=</span> <span class="s">'roc_auc'</span>
    <span class="p">)</span>

        
<span class="c"># Find the optimum parameters</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span>
<span class="c">#gs.grid_scores_</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="err">'penalty':</span><span class="w"> </span><span class="err">'l2',</span><span class="w"> </span><span class="err">'C':</span><span class="w"> </span><span class="err">2,</span><span class="w"> </span><span class="err">'solver':</span><span class="w"> </span><span class="err">'liblinear',</span><span class="w"> </span><span class="err">'fit_intercept':</span><span class="w"> </span><span class="err">True</span><span class="p">}</span><span class="w"> </span><span class="mf">0.849352865745</span><span class="w">
</span></code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Test the model performance with tunned parameters</span>
<span class="n">model_new</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span><span class="n">penalty</span> <span class="o">=</span> <span class="s">'l2'</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">model_new</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model_new</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">model_new</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"accuracy_score"</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicted</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"precision_score"</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">predicted</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"f1_score"</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">predicted</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"recall_score"</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">predicted</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"Score"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>


</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>accuracy_score 0.810055865922
precision_score 0.75
f1_score 0.71186440678
recall_score 0.677419354839
Score 0.797698826366
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">KFold</span>

<span class="c"># cross-validation where the model is fit to a portion of the training data, and the </span>
<span class="c"># is tested against the rest of the training data</span>

<span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'accuracy'</span><span class="p">,</span> <span class="s">'precision'</span><span class="p">,</span> <span class="s">'recall'</span><span class="p">,</span> <span class="s">'roc_auc'</span><span class="p">]:</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model_new</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"mean {}: {}, all: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="p">))</span>

</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>mean accuracy: 0.821092278719, all: [ 0.83333333  0.83333333  0.79661017]
mean precision: 0.757936507937, all: [ 0.76190476  0.76190476  0.75      ]
mean recall: 0.707936507937, all: [ 0.76190476  0.76190476  0.6       ]
mean roc_auc: 0.862657712658, all: [ 0.84859585  0.85347985  0.88589744]
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Check the model performance on test data</span>

<span class="n">model_score</span> <span class="o">=</span> <span class="n">model_new</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"Model Score </span><span class="si">%.2</span><span class="s">f </span><span class="se">\n</span><span class="s">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_score</span><span class="p">))</span>

<span class="n">confusion_matrix</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicted</span><span class="p">)</span>

<span class="k">print</span> <span class="n">confusion_matrix</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Model Score 0.83 

[[103  14]
 [ 20  42]]
</code></pre>
</div>

<p>The logistic regression model has been able to identify 103 passengers who were actually survived correctly, 
and model predicted correctly that 43 passengers would have died. We know that the model can not predict 100% correct results all the time(False positives). In the same way, we had 14 passengers who died were incorrectly classified as passngers survived and 19 passsngers who survived were incorrectly classified as died(True Negatives).</p>

<h4 id="plot-the-roc-curve">15. Plot the ROC curve</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">auc_plotting_function</span><span class="p">(</span><span class="n">rate1</span><span class="p">,</span> <span class="n">rate2</span><span class="p">,</span> <span class="n">rate1_name</span><span class="p">,</span> <span class="n">rate2_name</span><span class="p">,</span> <span class="n">curve_name</span><span class="p">):</span>
    <span class="n">AUC</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">rate1</span><span class="p">,</span> <span class="n">rate2</span><span class="p">)</span>
    <span class="c"># Plot of a ROC curve for class 1 (has_cancer)</span>
    <span class="c">#plt.figure(figsize=[11,9])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rate1</span><span class="p">,</span> <span class="n">rate2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">curve_name</span> <span class="o">+</span> <span class="s">' (area = </span><span class="si">%0.2</span><span class="s">f)'</span> <span class="o">%</span> <span class="n">AUC</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'k--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">rate1_name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">rate2_name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">curve_name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">"lower right"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c"># plot receiving operator characteristic curve</span>
<span class="k">def</span> <span class="nf">plot_roc</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">):</span>
    <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span>
    <span class="n">auc_plotting_function</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="s">'False Positive Rate (1-specificity)'</span><span class="p">,</span> <span class="s">'True Positive Rate (sensitivity)'</span><span class="p">,</span> <span class="s">'ROC'</span><span class="p">)</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
<span class="n">Y_score</span> <span class="o">=</span> <span class="n">logreg</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="n">Y_score</span><span class="o">.</span><span class="n">shape</span>
<span class="n">plot_roc</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">Y_score</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>(179,)
(179,)
</code></pre>
</div>

<p><img src="output_108_1.png" alt="png" /></p>

<p>Mean accuracy of logistic regression model is 82.66%
Roc-AUC of 86.59 shows that the area under the curve covers 86.5% of the area. This seems to be a pretty good model, We have got a really good lift in the first 2 deciles where 20% data gives us 80% correct predictions.</p>

<h4 id="what-does-the-roc-curve-tell-us">16. What does the ROC curve tell us?</h4>

<p>RoC curve gives us a clear indication about the impact of the model. If we did not have any model, the random prediction is specified as dotted line. And the blue thick line shows how much the model has been able to predict correctly. The larger the area covered by the blue line, suggest that the model has been able to predict correctly</p>

<h4 id="explain-the-difference-between-the-difference-between-the-l1-lasso-and-l2-ridge-penalties-on-the-model-coefficients">3. Explain the difference between the difference between the L1 (Lasso) and L2 (Ridge) penalties on the model coefficients.</h4>

<p>Lasso and Ridge are the regularisation techniques. 
Ridge uses L2 regularisation while lasso uses L1 regularisation. In ridge regression, the penalty is the sum of the squares of the coefficients and for the Lasso, it’s the sum of the absolute values of the coefficients.
Ridge allows all parameters to be there in the model, however some parameters might have very small coefficents.
Lasso regression excludes some parameters who do not add more value to the model. So Lasso regression is effectively reduces the number of predictors.</p>

<h4 id="what-hypothetical-situations-are-the-ridge-and-lasso-penalties-useful">4. What hypothetical situations are the Ridge and Lasso penalties useful?</h4>

<p>When we have a lot of predictors, say 500, then we need to reduce the dimension of data. As the number of predictors increases, there r square increases, may be in a vary small amount. We do not want to have 500 variables predicting the outcome of the model. So Ridge and Lasso comes into picture. These regularisation technique, penalises the parameter coefficents based on the number of parameters being added to the regression. 
So effectively, it helps in reducing the dimensions of the data and also helps in avoiding the overfitting.</p>

<h4 id="bonus-explain-how-the-regularization-strength-c-modifies-the-regression-loss-function-why-do-the-ridge-and-lasso-penalties-have-their-respective-effects-on-the-coefficients">5. [BONUS] Explain how the regularization strength (C) modifies the regression loss function. Why do the Ridge and Lasso penalties have their respective effects on the coefficients?</h4>

<p>C is inverse of regularization strength. It must be a positive float. Smaller values specify stronger regularization. This means, if we have bigger value of C, we might not be able to reach global optima or it might take a very long time to reach global optima, as the model will keep on searching with longer steps, while if we have a very small C, we have more chance to reach global optima and it might take much longer again, as we are taking very small steps.</p>

<p>Lasso excludes the parameters while ridge keep all parameters even if they have a very small parameter estimates</p>

<h4 id="a-bonus-you-decide-that-you-want-to-minimize-false-positives-use-the-predicted-probabilities-from-the-model-to-set-your-threshold-for-labeling-the-positive-class-to-need-at-least-90-confidence-how-and-why-does-this-affect-your-confusion-matrix">6.a. [BONUS] You decide that you want to minimize false positives. Use the predicted probabilities from the model to set your threshold for labeling the positive class to need at least 90% confidence. How and why does this affect your confusion matrix?</h4>

<p>False positives are primarily false alarms when actually the event has not happened. E.g. if we are testing for cancer, we do not want any patient to be told that they have cancer when actually they don’t. In certain cases, we would like to reduce false postives. There are many applications where we would like to reduce false positives like in fraud, airline failures, surgery failures etc. It depends on the business objective on how much false postives could be allowed.</p>

<p>Without any threshold, sklearn selects observations having score &gt;0.5 to be 1 and observations having score &lt;=0.5 to be 0. But for airline failure that score could be 0.95. If we change the threshold to say, 0.95, the confusion matrix will change, as we will select any observation having score &gt;0.95 to be 1 and rest all to be 0.</p>

<h2 id="part-6-gridsearch-and-knn">Part 6: Gridsearch and kNN</h2>

<h4 id="perform-gridsearch-for-the-same-classification-problem-as-above-but-use-kneighborsclassifier-as-your-estimator">1. Perform Gridsearch for the same classification problem as above, but use KNeighborsClassifier as your estimator</h4>

<p>At least have number of neighbors and weights in your parameters dictionary.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">#from sklearn.neighbors import KNeighborsClassifier</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">scores_test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
    <span class="n">predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> 
    <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predict</span><span class="p">)</span>
    <span class="n">scores_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">))</span>
<span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">scores_test</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scores_test</span><span class="p">))</span> <span class="k">if</span> <span class="n">scores_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">scores_test</span><span class="p">)]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>[(3, 0.78731343283582089)]
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">score_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">score_means</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">accuracy_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">precision_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">f1_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">recall_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">predicted</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">accuracy_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">predicted</span><span class="p">))</span>
    <span class="n">precision_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">predicted</span><span class="p">))</span>
    <span class="n">f1_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">predicted</span><span class="p">))</span>
    <span class="n">recall_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">predicted</span><span class="p">))</span>
    <span class="n">score_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
    <span class="n">score_means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
<span class="c"># Best k</span>
<span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">score_means</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">score_means</span><span class="p">))</span> <span class="k">if</span> <span class="n">score_means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">score_means</span><span class="p">)]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>[(7, 0.77340820423670309)]
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">line_1</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">),</span><span class="n">scores_test</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">line_2</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">),</span><span class="n">score_means</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s">'b'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'k'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">line_1</span><span class="p">,</span> <span class="n">line_2</span><span class="p">],</span> <span class="p">[</span><span class="s">'Test set'</span><span class="p">,</span><span class="s">'5 CV'</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="output_125_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">line_1</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">),</span><span class="n">scores_test</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">line_2</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">),</span><span class="n">score_means</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s">'b'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'k'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">line_1</span><span class="p">,</span> <span class="n">line_2</span><span class="p">],</span> <span class="p">[</span><span class="s">'Test set'</span><span class="p">,</span><span class="s">'5 CV'</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="output_126_0.png" alt="png" /></p>

<h4 id="fit-a-new-knn-model-with-the-optimal-parameters-found-in-gridsearch">5. Fit a new kNN model with the optimal parameters found in gridsearch.</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">grid_search</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">'n_neighbors'</span><span class="p">:(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="s">'leaf_size'</span><span class="p">:(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">)}</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
<span class="k">print</span> <span class="n">knn</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">best_params_</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>/Users/ipm/anaconda/lib/python2.7/site-packages/sklearn/cross_validation.py:44: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.
  "This module will be removed in 0.20.", DeprecationWarning)
/Users/ipm/anaconda/lib/python2.7/site-packages/sklearn/grid_search.py:43: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. This module will be removed in 0.20.
  DeprecationWarning)


['n_neighbors', 'n_jobs', 'algorithm', 'metric', 'metric_params', 'p', 'weights', 'leaf_size']





{'leaf_size': 3, 'n_neighbors': 3}
</code></pre>
</div>

<h4 id="construct-the-confusion-matrix-for-the-optimal-knn-model-is-it-different-from-the-logistic-regression-model-if-so-how">6. Construct the confusion matrix for the optimal kNN model. Is it different from the logistic regression model? If so, how?</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">leaf_size</span><span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">output_dt</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"fit to all test data:"</span><span class="p">,</span><span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>fit to all test data: 0.738805970149
</code></pre>
</div>

<p>Knn model does not look very good, as we have got accurancy of 73%. Regression was much better model in this case.</p>

<h4 id="bonus-plot-the-roc-curves-for-the-optimized-logistic-regression-model-and-the-optimized-knn-model-on-the-same-plot">7. [BONUS] Plot the ROC curves for the optimized logistic regression model and the optimized kNN model on the same plot.</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">Mean_List</span><span class="o">=</span><span class="p">[]</span>
<span class="n">N</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">knn</span><span class="o">=</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
    <span class="n">knn_model</span><span class="o">=</span><span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
    <span class="n">Mean_List</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">knn_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
    <span class="n">N</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">Output1</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'Number'</span><span class="p">:</span><span class="n">N</span><span class="p">,</span><span class="s">'Mean_Accuracy'</span><span class="p">:</span><span class="n">Mean_List</span><span class="p">})</span>
<span class="n">Output1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">Mean_List</span><span class="o">=</span><span class="p">[]</span>
<span class="n">Mean_List2</span><span class="o">=</span><span class="p">[]</span>
<span class="n">N</span><span class="o">=</span><span class="p">[]</span>
<span class="n">Recall</span><span class="o">=</span><span class="p">[]</span>
<span class="n">Precision</span><span class="o">=</span><span class="p">[]</span>
<span class="n">f1</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">knn</span><span class="o">=</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
    <span class="n">accuracies</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">accuracies2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_pred</span><span class="p">))</span>
    <span class="n">Mean_List</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracies</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">Mean_List2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracies2</span><span class="p">)</span>
    <span class="n">N</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">Precision</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">average_precision_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)))</span>
    <span class="n">f1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)))</span>
    <span class="n">Recall</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)))</span>
<span class="n">Output2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'Number'</span><span class="p">:</span><span class="n">N</span><span class="p">,</span><span class="s">'Mean_Accuracy'</span><span class="p">:</span><span class="n">Mean_List</span><span class="p">,</span><span class="s">'Mean_Accuracy_2'</span><span class="p">:</span><span class="n">Mean_List2</span><span class="p">,</span>
                      <span class="s">'Recall'</span><span class="p">:</span><span class="n">Recall</span><span class="p">,</span><span class="s">'F1'</span><span class="p">:</span><span class="n">f1</span><span class="p">,</span><span class="s">'Precision'</span><span class="p">:</span><span class="n">Precision</span><span class="p">})</span>
<span class="n">Output2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c"># Best k</span>
<span class="n">Output2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'F1'</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c"># plot mean accuracy versus k</span>
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">Output2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'Number'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Mean_Accuracy'</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">Output2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'Number'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Recall'</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">Output2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'Number'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'F1'</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
<span class="n">Output2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'Number'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Precision'</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">)</span>


</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1249da2d0&gt;
</code></pre>
</div>

<p><img src="output_133_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
<span class="n">knn_model</span><span class="o">=</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">knn_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_score</span> <span class="o">=</span> <span class="n">knn_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c">#print y_score</span>
<span class="n">Y_score</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">y_score</span><span class="p">:</span>
    <span class="n">Y_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">print</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Y_score</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">Y_score</span><span class="p">)</span>
<span class="c">#print Y_score</span>
<span class="n">plot_roc</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">Y_score</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>(268,)
</code></pre>
</div>

<p><img src="output_134_1.png" alt="png" /></p>

<p>Regularised Knn is much better than knn model. Regularised knn has shown the accuracy of 83%.. not bad…</p>

<h2 id="part-7-bonus-precision-recall">Part 7: [BONUS] Precision-recall</h2>

<h4 id="gridsearch-the-same-parameters-for-logistic-regression-but-change-the-scoring-function-to-averageprecision">1. Gridsearch the same parameters for logistic regression but change the scoring function to ‘average_precision’</h4>

<p><code class="highlighter-rouge">'average_precision'</code> will optimize parameters for area under the precision-recall curve instead of for accuracy.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Fit the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="c"># Tune the hyper parameters using grid search</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span>
    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">'C'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                 <span class="s">'penalty'</span><span class="p">:[</span><span class="s">'l1'</span><span class="p">,</span><span class="s">'l2'</span><span class="p">],</span>
                 <span class="s">'fit_intercept'</span><span class="p">:[</span><span class="bp">True</span><span class="p">],</span>
                 <span class="s">'solver'</span><span class="p">:[</span><span class="s">'liblinear'</span><span class="p">]},</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">scoring</span> <span class="o">=</span> <span class="s">'average_precision'</span>
    <span class="p">)</span>

        
<span class="c"># Find the optimum parameters</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="err">'penalty':</span><span class="w"> </span><span class="err">'l2',</span><span class="w"> </span><span class="err">'C':</span><span class="w"> </span><span class="err">2,</span><span class="w"> </span><span class="err">'solver':</span><span class="w"> </span><span class="err">'liblinear',</span><span class="w"> </span><span class="err">'fit_intercept':</span><span class="w"> </span><span class="err">True</span><span class="p">}</span><span class="w"> </span><span class="mf">0.796636959996</span><span class="w">
</span></code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="c"># Fit the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="c"># Tune the hyper parameters using grid search</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span>
    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">'C'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">),</span>
                 <span class="s">'penalty'</span><span class="p">:[</span><span class="s">'l1'</span><span class="p">,</span><span class="s">'l2'</span><span class="p">],</span>
                 <span class="s">'fit_intercept'</span><span class="p">:[</span><span class="bp">True</span><span class="p">],</span>
                 <span class="s">'solver'</span><span class="p">:[</span><span class="s">'liblinear'</span><span class="p">]},</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">scoring</span> <span class="o">=</span> <span class="s">'average_precision'</span>
    <span class="p">)</span>

        
<span class="c"># Find the optimum parameters</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="err">'penalty':</span><span class="w"> </span><span class="err">'l2',</span><span class="w"> </span><span class="err">'C':</span><span class="w"> </span><span class="err">0.30000000000000004,</span><span class="w"> </span><span class="err">'solver':</span><span class="w"> </span><span class="err">'liblinear',</span><span class="w"> </span><span class="err">'fit_intercept':</span><span class="w"> </span><span class="err">True</span><span class="p">}</span><span class="w"> </span><span class="mf">0.797890063391</span><span class="w">
</span></code></pre>
</div>

<h4 id="examine-the-best-parameters-and-score-are-they-different-than-the-logistic-regression-gridsearch-in-part-5">2. Examine the best parameters and score. Are they different than the logistic regression gridsearch in part 5?</h4>

<p>the parameters are same but the scores are different.</p>

<h4 id="create-the-confusion-matrix-is-it-different-than-when-you-optimized-for-the-accuracy-if-so-why-would-this-be">3. Create the confusion matrix. Is it different than when you optimized for the accuracy? If so, why would this be?</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">model_new</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">0.3</span> <span class="p">,</span><span class="n">penalty</span> <span class="o">=</span> <span class="s">'l2'</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">model_new</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">predicted</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">model_new</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">model_score</span> <span class="o">=</span> <span class="n">model_new</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"Model Score </span><span class="si">%.2</span><span class="s">f </span><span class="se">\n</span><span class="s">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_score</span><span class="p">))</span>

<span class="n">confusion_matrix</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicted</span><span class="p">)</span>

<span class="k">print</span> <span class="n">confusion_matrix</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Model Score 0.81 

[[137  20]
 [ 32  79]]
</code></pre>
</div>

<h2 id="part-8-decision-trees-ensembles-bagging">Part 8: Decision trees, ensembles, bagging</h2>

<h4 id="gridsearch-a-decision-tree-classifier-model-on-the-data-searching-for-optimal-depth-create-a-new-decision-tree-model-with-the-optimal-parameters">1. Gridsearch a decision tree classifier model on the data, searching for optimal depth. Create a new decision tree model with the optimal parameters.</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">#from sklearn import tree</span>
<span class="c">#from sklearn.cross_validation import cross_val_score, KFold</span>

<span class="c"># build model</span>
<span class="c">#dtc = tree.DecisionTreeClassifier()</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">dtc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">output_dt</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"fit to all test data:"</span><span class="p">,</span><span class="n">dtc</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>fit to all test data: 0.761194029851
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">'max_depth'</span><span class="p">:(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="s">'min_samples_leaf'</span><span class="p">:(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="s">'max_features'</span> <span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">)}</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="k">print</span> <span class="n">dtc</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">dtc</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">best_params_</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>['presort', 'splitter', 'max_leaf_nodes', 'min_samples_leaf', 'min_samples_split', 'min_weight_fraction_leaf', 'criterion', 'random_state', 'min_impurity_split', 'max_features', 'max_depth', 'class_weight']





{'max_depth': 4, 'max_features': 5, 'min_samples_leaf': 3}
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">dtc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">output_dt</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"fit to all test data:"</span><span class="p">,</span><span class="n">dtc</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>fit to all test data: 0.813432835821
</code></pre>
</div>

<h4 id="compare-the-performace-of-the-decision-tree-model-to-the-logistic-regression-and-knn-models">2. Compare the performace of the decision tree model to the logistic regression and kNN models.</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Random Forests</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="n">random_forest</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>

<span class="n">random_forest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">Y_pred</span> <span class="o">=</span> <span class="n">random_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">random_forest</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>0.80223880597014929
</code></pre>
</div>

<h4 id="plot-all-three-optimized-models-roc-curves-on-the-same-plot">3. Plot all three optimized models’ ROC curves on the same plot.</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">plot_roc</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="output_152_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">grid_search</span>
<span class="c"># grid search the parameters</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">'n_estimators'</span><span class="p">:(</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="s">'max_features'</span><span class="p">:(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="s">'max_depth'</span><span class="p">:(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)}</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="k">print</span> <span class="n">rfc</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">rfc</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">best_params_</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>['warm_start', 'oob_score', 'n_jobs', 'verbose', 'max_leaf_nodes', 'bootstrap', 'min_samples_leaf', 'n_estimators', 'min_samples_split', 'min_weight_fraction_leaf', 'criterion', 'random_state', 'min_impurity_split', 'max_features', 'max_depth', 'class_weight']





{'max_depth': 6, 'max_features': 3, 'n_estimators': 100}
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">rfc1</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">rfc1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_rfc_pred</span> <span class="o">=</span> <span class="n">rfc1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span> <span class="n">y_rfc_pred</span><span class="o">.</span><span class="n">shape</span>
<span class="n">rfc1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"Model Score </span><span class="si">%.2</span><span class="s">f </span><span class="se">\n</span><span class="s">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">rfc1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)))</span>

<span class="n">confusion_matrix</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_rfc_pred</span><span class="p">)</span>

<span class="k">print</span> <span class="n">confusion_matrix</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>(268,)
Model Score 0.82 

[[141  16]
 [ 33  78]]
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">plot_roc</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_rfc_pred</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="output_155_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
</code></pre>
</div>

<p>```python</p>








<script src="/js/mermaid.min.js"></script>
<link rel="stylesheet" href="/css/mermaid.forest.css">
<script>mermaid.initialize({startOnLoad:true});</script>

<!-- Get Content for This Post and Split at Pound Signs to Find Headers -->





<!-- Encapsulate in Capture to Handle the Whitespace and Allow Commenting -->


<!-- Make the Graph -->
<h1> Workflow Overview </h1>

<!-- Strip HTML and Seperate at Line Breaks -->



<!-- Strip Each Line of Whitespace and Only Keep Lines Longer than 3 -->
<div class="mermaid" id="mermaidworkflow" style="margin-left:100px">

graph TB

end

</div>





<hr>

<ul class="pager">
	
	<li class="previous">
		<a href="/2016/11/14/Titanic-Survival/" data-toggle="tooltip" data-placement="top" title="GA Project week 5 - Who survived the Titanic shipwreck?">&larr; Previous Post</a>
	</li>
	
	
</ul>

            </div>
        </div>
    </div>
</article>

<hr>

<div class="container" style="padding-right: 50px;padding-left: 50px;">
<div class="row">
<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1" id="disqus_thread">

</div>
</div>
</div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = '';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


<hr>





    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://linkedin.com/in/gregoryvial">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/GregVial">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:ds@gregvi.al">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy;  2016</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Contact Form JavaScript -->
<script src="/js/jqBootstrapValidation.js"></script>
<script src="/js/contact_me.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-86523398-1', 'auto');
  ga('send', 'pageview');

</script>



</body>

</html>
